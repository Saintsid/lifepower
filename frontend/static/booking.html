<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Запись на консультацию в центр Сила жизни в Таганроге.">
    <title>Запись на консультацию | Сила жизни | Таганрог</title>
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="index.html" class="logo-link">
                        <img src="images/lifepower_simbol.jpeg" alt="Логотип" class="logo-icon">
                        <h1>Сила жизни</h1>
                    </a>
                </div>
                <nav>
                    <ul>
                        <li><a href="index.html">Главная</a></li>
                        <li><a href="services.html">Услуги</a></li>
                        <li><a href="about.html">О центре</a></li>
                        <li><a href="contacts.html">Контакты</a></li>
                        <li><a href="booking.html" class="booking-btn active">Записаться</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <div class="hero-image-block">
                    <img src="images/lifepower.jpeg" alt="Центр Сила жизни" class="hero-image">
                </div>
                <div class="hero-text">
                    <h2>Запись на консультацию</h2>
                    <p>Заполните форму, и мы свяжемся с Вами</p>
                </div>
            </div>
        </div>
    </section>

    <main>
        <div class="container">
            <section>
                <div style="margin-top: 1rem;">
                    <h2>Запись на консультацию</h2>
                    <p>Оставьте заявку, и мы свяжемся с Вами в ближайшее время для уточнения деталей и записи.</p>
                    
                    <form class="contact-form" id="contactForm">
                        <div class="form-group">
                            <label for="name">Ваше имя *</label>
                            <input type="text" id="name" name="name" required>
                        </div>

                        <div class="form-group">
                            <label for="phone">Телефон *</label>
                            <input type="tel" id="phone" name="phone" required placeholder="+7 (___) ___-__-__">
                        </div>

                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" name="email" placeholder="example@mail.com">
                        </div>

                        <div class="form-group">
                            <label for="service">Интересующая услуга</label>
                            <select id="service" name="service" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem;">
                                <option value="">Выберите услугу</option>
                                <option value="nutrition">Нутрициология</option>
                                <option value="hirudotherapy">Гирудотерапия</option>
                                <option value="massage">Биоэнергетический массаж</option>
                                <option value="phytobarrel">Фитобочка</option>
                                <option value="stress">Управление стрессом</option>
                                <option value="complex">Комплексная программа</option>
                                <option value="consultation">Первичная консультация</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="message">Комментарий</label>
                            <textarea id="message" name="message" placeholder="Расскажите о своих пожеланиях или вопросах"></textarea>
                        </div>

                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="agreePrivacy" required>
                                Я согласен с <a href="privacy.html" target="_blank">политикой конфиденциальности</a> и даю согласие на обработку персональных данных *
                            </label>
                        </div>

                        <button type="submit" class="btn">Отправить заявку</button>
                    </form>
                </div>
            </section>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 Сила жизни. Оздоровительный центр в Таганроге.</p>
            <p>Ростовская область, Таганрог, Смирновский переулок, 10</p>
        </div>
    </footer>

    <script src="js/auth.js"></script>
    <script src="js/form.js"></script>
    <script>
        // Автозаполнение для залогиненных пользователей
        async function prefillForm() {
            const user = await getCurrentUser();
            if (user) {
                document.getElementById('name').value = user.name;
                document.getElementById('phone').value = user.phone;
                document.getElementById('email').value = user.email;
            }
        }
        prefillForm();

        document.getElementById('contactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            if (!document.getElementById('agreePrivacy').checked) {
                alert('Необходимо согласиться с политикой конфиденциальности');
                return;
            }
            
            const formData = {
                name: document.getElementById('name').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                service: document.getElementById('service').value,
                message: document.getElementById('message').value
            };
            
            try {
                const response = await apiRequest('/bookings', {
                    method: 'POST',
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    alert('Спасибо за Вашу заявку! Мы свяжемся с Вами в ближайшее время.');
                    this.reset();
                } else {
                    alert('Ошибка при отправке заявки. Пожалуйста, попробуйте позже.');
                }
            } catch (error) {
                alert('Ошибка подключения к серверу');
            }
        });
    </script>
</body>
</html>

